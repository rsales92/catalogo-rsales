<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSales Lavacar - Cat√°logo de Servi√ßos com Carrinho</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-red: #dc3545;
            --dark-red: #c82333;
            --light-grey: #f8f9fa;
            --medium-grey: #e9ecef;
            --dark-grey: #343a40;
            --black: #212529;
            --white: #ffffff;
            --blue-light: #e6f7ff;
            --blue-dark: #0056b3;
            --green: #28a745;
            --dark-green: #1e7e34;
        }
        body {
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--light-grey);
            color: var(--black);
            line-height: 1.6;
            overflow-x: hidden;
            padding-bottom: 70px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 20px;
            box-sizing: border-box;
        }
        header {
            background-color: var(--black);
            color: var(--white);
            padding: 15px 0;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 700;
            color: var(--primary-red);
        }
        main {
            padding: 40px 0;
            max-width: 900px;
            margin: 40px auto;
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        h2 { color: var(--black); text-align: center; margin-bottom: 20px; font-weight: 700; font-size: 2em; }
        .info-text { text-align: center; margin-bottom: 30px; font-size: 1.1em; color: var(--dark-grey); padding: 10px 0; border-bottom: 1px solid var(--medium-grey); border-top: 1px solid var(--medium-grey); }
        #car-selection .button-group { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-top: 30px; margin-bottom: 30px; }
        .car-type-btn, .back-button { background-color: var(--primary-red); color: var(--white); border: none; padding: 12px 25px; font-size: 16px; border-radius: 5px; cursor: pointer; transition: background-color 0.3s ease, transform 0.2s ease; flex: 1 1 auto; max-width: 200px; font-weight: 600; }
        .car-type-btn:hover, .back-button:hover { background-color: var(--dark-red); transform: translateY(-2px); }
        .car-type-btn.active { background-color: var(--dark-red); border: 2px solid var(--primary-red); }

        /* Servi√ßos Avulsos */
        .additional-services { padding-top: 10px; margin-bottom: 40px; }
        .additional-services h3 { color: var(--black); font-size: 24px; margin-bottom: 15px; text-align: center; font-weight: 700; border-bottom: 2px solid var(--medium-grey); padding-bottom: 10px; }
        .service-item { background-color: var(--light-grey); border: 1px solid var(--medium-grey); border-radius: 5px; padding: 15px; margin-bottom: 15px; display: flex; align-items: center; gap: 15px; }
        .service-item input[type="checkbox"] { min-width: 20px; height: 20px; cursor: pointer; accent-color: var(--primary-red); }
        .service-details { flex-grow: 1; }
        .service-item h4 { color: var(--primary-red); margin-top: 0; margin-bottom: 5px; font-size: 1.2em; font-weight: 600; }
        .service-item .price { font-weight: bold; color: var(--black); font-size: 1.1em; display: block; margin-top: 5px; }

        /* Estilos dos Combos */
        .combo-section-group { padding: 0 20px; }
        .combo-section-group h3 { color: var(--black); font-size: 24px; margin-bottom: 15px; text-align: center; font-weight: 700; border-bottom: 2px solid var(--medium-grey); padding-bottom: 10px; margin-top: 40px; }
        .combo-section { background-color: var(--light-grey); border: 1px solid var(--medium-grey); border-radius: 8px; padding: 20px; margin-bottom: 25px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08); }
        .combo-section h4 { color: var(--primary-red); margin-top: 0; font-size: 1.3em; border-bottom: 1px solid var(--primary-red); padding-bottom: 8px; margin-bottom: 15px; font-weight: 600; }
        .combo-section table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
        .combo-section th, .combo-section td { border: 1px solid #dee2e6; padding: 10px; text-align: left; color: var(--black); }
        .combo-section th { background-color: var(--medium-grey); color: var(--black); }
        .highlight-bold { font-weight: bold; }
        .combo-section ul { list-style: none; padding: 0; }
        .combo-section ul li { margin-bottom: 8px; padding-left: 20px; position: relative; color: var(--dark-grey); }
        .combo-section ul li::before { content: '‚Ä¢'; color: var(--primary-red); position: absolute; left: 0; }
        .back-button { display: block; width: fit-content; margin: 30px auto 0; }
        
        /* Carrinho Flutuante */
        .floating-cart-wrapper {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        #floating-cart-icon {
            background-color: var(--white); 
            color: var(--primary-red);
            border: 2px solid var(--primary-red); 
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s, transform 0.2s, color 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin-left: auto;
        }

        #floating-cart-icon:hover {
            background-color: var(--light-grey);
            color: var(--dark-red);
            transform: scale(1.05);
        }

        #cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--green);
            color: var(--white);
            font-size: 12px;
            font-weight: 700;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
        }
        
        #cart-summary {
            position: absolute;
            bottom: 75px;
            right: 0;
            width: 300px; /* Largura padr√£o para telas maiores */
            max-height: 400px;
            overflow-y: auto;
            background-color: var(--medium-grey);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
            padding: 20px;
            transition: opacity 0.3s ease, transform 0.3s ease;
            transform: translateY(10px);
            opacity: 0;
            visibility: hidden;
            border-top: 4px solid var(--primary-red);
        }

        #cart-summary.active {
            transform: translateY(0);
            opacity: 1;
            visibility: visible;
        }

        #cart-summary h3 { color: var(--black); font-size: 18px; margin-top: 0; margin-bottom: 10px; border-bottom: 1px dashed var(--dark-grey); padding-bottom: 5px; }
        #cart-items { list-style: none; padding: 0; margin-bottom: 15px; }
        #cart-items li { font-size: 0.9em; margin-bottom: 5px; display: flex; justify-content: space-between; color: var(--dark-grey); }
        #cart-items li strong { color: var(--black); font-weight: 600; }
        #cart-total { font-size: 1.2em; font-weight: 700; color: var(--black); display: flex; justify-content: space-between; padding: 10px 0; border-top: 2px solid var(--primary-red); }

        .checkout-button {
            display: block;
            width: 100%;
            max-width: none;
            background-color: var(--green);
            margin-top: 15px;
            border: none;
            padding: 10px;
            color: var(--white);
            font-weight: 600;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .checkout-button:hover {
            background-color: var(--dark-green);
        }
        .checkout-button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        
        #services-display #cart-summary {
            display: none !important;
        }

        .appointment-message {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            background-color: var(--blue-light);
            border: 1px solid #b3e0ff;
            border-radius: 5px;
            font-size: 1.1em;
            color: var(--blue-dark);
        }
        .appointment-message a {
            color: var(--blue-dark);
            font-weight: bold;
            text-decoration: none;
        }
        .appointment-message a:hover {
            text-decoration: underline;
        }
        
        /* üöÄ AJUSTE DA MEDIA QUERY PARA MELHOR RESPONSIVIDADE EM CELULARES */
        @media (max-width: 400px) {
            .floating-cart-wrapper {
                bottom: 10px;
                right: 10px;
            }
            #floating-cart-icon {
                width: 50px;
                height: 50px;
                font-size: 24px;
            }
            
            #cart-summary {
                width: 90vw; /* Ocupa 90% da largura da tela */
                right: auto; /* Remove a fixa√ß√£o da direita */
                left: 50%; /* Move para o centro */
                transform: translateX(-50%) translateY(10px); /* Move 50% para a esquerda e 10px para baixo */
                bottom: 65px; /* Ajusta a posi√ß√£o acima do √≠cone */
            }
            
            #cart-summary.active {
                 transform: translateX(-50%) translateY(0); /* Mant√©m centralizado ao abrir */
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>RSales Lavacar - Cat√°logo</h1>
        </div>
    </header>
    
    <main class="container">
        <section id="car-selection">
            <p class="info-text">
                Selecione a categoria do seu ve√≠culo para visualizar os pre√ßos e combos exclusivos.
            </p>
            <h2>Selecione o tipo de carro:</h2>
            <div class="button-group">
                <button class="car-type-btn" data-car="SUV">SUV</button>
                <button class="car-type-btn" data-car="Hatch">Hatch</button>
                <button class="car-type-btn" data-car="Sed√£">Sed√£</button>
                <button class="car-type-btn" data-car="Picape">Picape</button>
            </div>
            <div class="appointment-message">
                Pronto para agendar? <a href="https://calendly.com/rsaleslavacar/agendamento" target="_blank">Clique aqui para o agendamento!</a>
            </div>
        </section>

        <section id="services-display" style="display: none;">
            <h2 id="car-type-title"></h2>
            <div id="services-content">
            </div>
            
            <button id="back-to-selection" class="back-button">Voltar √† Sele√ß√£o de Carros</button>
        </section>
    </main>

    <section class="floating-cart-wrapper">
        <div id="floating-cart-icon">
            <i class="fas fa-shopping-cart"></i>
            <span id="cart-count">0</span>
        </div>
    </section>
    
    <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>

    <script>
        // Estrutura de dados (Inalterada)
        const carData = {
            "SUV": {
                "additional_services": [
                    {"name": "Lavagem detalhada (com aplica√ß√£o de cera)", "description": "Limpeza profunda e minuciosa, garantindo que cada canto do seu carro esteja impec√°vel.", "price": "R$ 140,00"},
                    {"name": "Hidrata√ß√£o dos pl√°sticos externos", "description": "Limpeza e descontamina√ß√£o dos pl√°sticos externos (para-choques, frisos, retrovisores), com realce da cor original.", "price": "R$ 60,00"},
                    {"name": "Hidrata√ß√£o dos pl√°sticos internos", "description": "Limpeza e descontamina√ß√£o dos pl√°sticos internos (painel, portas, consoles), com realce da cor original.", "price": "R$ 80,00"},
                    {"name": "Descontamina√ß√£o e prote√ß√£o dos vidros", "description": "Limpeza profunda dos vidros externos, remo√ß√£o de res√≠duos como chuva √°cida, gordura e polui√ß√£o, com aplica√ß√£o de selante hidrof√≥bico.", "price": "R$ 170,00"},
                    {"name": "Higieniza√ß√£o e hidrata√ß√£o dos bancos de couro", "description": "Limpeza e hidrata√ß√£o profunda para manter seus bancos de couro macios e livres de rachaduras.", "price": "R$ 150,00"},
                    {"name": "Polimento Comercial", "description": "Polimento da lataria, removendo manchas e riscos leves. Indicado para recuperar a cor e o brilho do carro.", "price": "R$ 490,00"},
                    {"name": "Limpeza dos far√≥is (amarelados ou opacos)", "description": "Renova o brilho e remove o amarelado dos far√≥is, melhorando a ilumina√ß√£o e a est√©tica.", "price": "R$ 60,00 cada"}
                ],
                "combos": [
                    {"name": "COMBO 01 - Lavagem Detalhada", "table": [["Lavagem detalhada com aplica√ß√£o de cera", "R$ 140,00"], ["Hidrata√ß√£o dos pl√°sticos externos", "R$ 60,00"], ["<span class='highlight-bold'>Total Avulso</span>", "<span class='highlight-bold'>R$ 200,00</span>"], ["<span class='highlight-bold' style='color: var(--dark-red);'>Pre√ßo do Combo (Desconto)</span>", "<span class='highlight-bold' style='color: var(--dark-red);'>R$ 170,00</span>"]], "includes": ["Lavagem detalhada completa.", "Hidrata√ß√£o dos pl√°sticos externos (para-choques, frisos)."]}, 
                    {"name": "COMBO 02 - Lavagem + Hidrata√ß√£o Completa", "table": [["Lavagem detalhada com aplica√ß√£o de cera", "R$ 140,00"], ["Hidrata√ß√£o dos pl√°sticos externos", "R$ 60,00"], ["Hidrata√ß√£o dos pl√°sticos internos", "R$ 80,00"], ["<span class='highlight-bold'>Total Avulso</span>", "<span class='highlight-bold'>R$ 280,00</span>"], ["<span class='highlight-bold' style='color: var(--dark-red);'>Pre√ßo do Combo (Desconto)</span>", "<span class='highlight-bold' style='color: var(--dark-red);'>R$ 238,00</span>"]], "includes": ["Itens do Combo 01", "Limpeza e descontamina√ß√£o dos pl√°sticos internos (painel, portas, consoles)."]}, 
                    {"name": "COMBO 03 - Lavagem Detalhada + Vidros Protegidos", "table": [["Lavagem detalhada com aplica√ß√£o de cera", "R$ 140,00"], ["Descontamina√ß√£o e prote√ß√£o dos vidros", "R$ 170,00"], ["<span class='highlight-bold'>Total Avulso</span>", "<span class='highlight-bold'>R$ 310,00</span>"], ["<span class='highlight-bold' style='color: var(--dark-red);'>Pre√ßo do Combo (Desconto)</span>", "<span class='highlight-bold' style='color: var(--dark-red);'>R$ 263,00</span>"]], "includes": ["Lavagem detalhada completa.", "Limpeza profunda, remo√ß√£o de chuva √°cida e aplica√ß√£o de selante hidrof√≥bico nos vidros."]}, 
                    {"name": "COMBO 04 - Est√©tica Premium com Polimento", "table": [["Lavagem + Polimento Comercial", "R$ 490,00"], ["Descontamina√ß√£o e prote√ß√£o dos vidros", "R$ 170,00"], ["<span class='highlight-bold'>Total Avulso</span>", "<span class='highlight-bold'>R$ 660,00</span>"], ["<span class='highlight-bold' style='color: var(--dark-red);'>Pre√ßo do Combo (Desconto)</span>", "<span class='highlight-bold' style='color: var(--dark-red);'>R$ 560,00</span>"]], "includes": ["Lavagem com descontamina√ß√£o de pintura", "Polimento para remo√ß√£o de riscos leves e manchas.", "Recupera√ß√£o do brilho e apar√™ncia da pintura."]}
                ]
            },
            "Hatch": {
                "additional_services": [
                    {"name": "Lavagem detalhada (com aplica√ß√£o de cera)", "description": "Limpeza profunda e minuciosa, garantindo que cada canto do seu carro esteja impec√°vel.", "price": "R$ 110,00"}, 
                    {"name": "Hidrata√ß√£o dos pl√°sticos externos", "description": "Limpeza e descontamina√ß√£o dos pl√°sticos externos.", "price": "R$ 40,00"}, 
                    {"name": "Hidrata√ß√£o dos pl√°sticos internos", "description": "Limpeza e descontamina√ß√£o dos pl√°sticos internos (painel, portas, consoles).", "price": "R$ 60,00"}, 
                    {"name": "Descontamina√ß√£o e prote√ß√£o dos vidros", "description": "Limpeza profunda dos vidros, remo√ß√£o de chuva √°cida e aplica√ß√£o de selante hidrof√≥bico.", "price": "R$ 150,00"}, 
                    {"name": "Higieniza√ß√£o e hidrata√ß√£o dos bancos de couro", "description": "Limpeza e hidrata√ß√£o profunda para manter seus bancos de couro macios.", "price": "R$ 120,00"}, 
                    {"name": "Polimento Comercial", "description": "Polimento da lataria, removendo manchas e riscos leves e recuperando o brilho.", "price": "R$ 350,00"}, 
                    {"name": "Limpeza dos far√≥is (amarelados ou opacos)", "description": "Renova o brilho e remove o amarelado dos far√≥is.", "price": "R$ 50,00 cada"}
                ],
                "combos": [
                    {"name": "COMBO 01 - Lavagem Detalhada", "table": [["Lavagem detalhada com aplica√ß√£o de cera", "R$ 110,00"], ["Hidrata√ß√£o dos pl√°sticos externos", "R$ 40,00"], ["<span class='highlight-bold'>Total Avulso</span>", "<span class='highlight-bold'>R$ 150,00</span>"], ["<span class='highlight-bold' style='color: var(--dark-red);'>Pre√ßo do Combo (Desconto)</span>", "<span class='highlight-bold' style='color: var(--dark-red);'>R$ 127,00</span>"]], "includes": ["Lavagem detalhada completa.", "Hidrata√ß√£o dos pl√°sticos externos."]}, 
                    {"name": "COMBO 02 - Lavagem + Hidrata√ß√£o Completa", "table": [["Lavagem detalhada com aplica√ß√£o de cera", "R$ 110,00"], ["Hidrata√ß√£o dos pl√°sticos externos", "R$ 40,00"], ["Hidrata√ß√£o dos pl√°sticos internos", "R$ 60,00"], ["<span class='highlight-bold'>Total Avulso</span>", "<span class='highlight-bold'>R$ 210,00</span>"], ["<span class='highlight-bold' style='color: var(--dark-red);'>Pre√ßo do Combo (Desconto)</span>", "<span class='highlight-bold' style='color: var(--dark-red);'>R$ 178,00</span>"]], "includes": ["Itens do Combo 01", "Limpeza e descontamina√ß√£o dos pl√°sticos internos."]}, 
                    {"name": "COMBO 03 - Lavagem Detalhada + Vidros Protegidos", "table": [["Lavagem detalhada com aplica√ß√£o de cera", "R$ 110,00"], ["Descontamina√ß√£o e prote√ß√£o dos vidros", "R$ 150,00"], ["<span class='highlight-bold'>Total Avulso</span>", "<span class='highlight-bold'>R$ 260,00</span>"], ["<span class='highlight-bold' style='color: var(--dark-red);'>Pre√ßo do Combo (Desconto)</span>", "<span class='highlight-bold' style='color: var(--dark-red);'>R$ 221,00</span>"]], "includes": ["Lavagem detalhada completa.", "Limpeza profunda, remo√ß√£o de chuva √°cida e aplica√ß√£o de selante hidrof√≥bico nos vidros."]}, 
                    {"name": "COMBO 04 - Est√©tica Premium com Polimento", "table": [["Lavagem + Polimento comercial", "R$ 350,00"], ["Descontamina√ß√£o e prote√ß√£o dos vidros", "R$ 150,00"], ["<span class='highlight-bold'>Total Avulso</span>", "<span class='highlight-bold'>R$ 500,00</span>"], ["<span class='highlight-bold' style='color: var(--dark-red);'>Pre√ßo do Combo (Desconto)</span>", "<span class='highlight-bold' style='color: var(--dark-red);'>R$ 425,00</span>"]], "includes": ["Lavagem com descontamina√ß√£o de pintura", "Polimento para remo√ß√£o de riscos leves e manchas.", "Recupera√ß√£o do brilho e apar√™ncia da pintura."]}
                ]
            }
        };

        carData.Sed√£ = carData.Hatch;
        carData.Picape = carData.SUV;


        document.addEventListener('DOMContentLoaded', () => {
            const carTypeButtons = document.querySelectorAll('.car-type-btn');
            const backButton = document.getElementById('back-to-selection');
            const carSelectionSection = document.getElementById('car-selection');
            const servicesDisplaySection = document.getElementById('services-display');
            const carTypeTitle = document.getElementById('car-type-title');
            const servicesContent = document.getElementById('services-content');
            
            const floatingCartWrapper = document.querySelector('.floating-cart-wrapper');
            const floatingCartIcon = document.getElementById('floating-cart-icon');
            const cartCountSpan = document.getElementById('cart-count');
            
            let cartSummaryElement;
            let cartItemsList;
            let totalPriceSpan;
            let checkoutButton;

            let cart = [];
            let currentCarType = '';
            let isCartOpen = false;
            
            // Seu n√∫mero de WhatsApp (Inalterado)
            const WHATSAPP_NUMBER = '5544997063542';

            const formatPrice = (priceText) => {
                const numStr = priceText.replace('R$', '').replace(',', '.').replace('cada', '').trim();
                const match = numStr.match(/(\d+\.?\d*)/);
                return match ? parseFloat(match[0]) : 0;
            };

            const formatToBRL = (number) => {
                return new Intl.NumberFormat('pt-BR', {
                    style: 'currency',
                    currency: 'BRL'
                }).format(number);
            };

            const toggleFloatingCart = () => {
                if (!cartSummaryElement) return;
                
                isCartOpen = !isCartOpen;
                cartSummaryElement.classList.toggle('active', isCartOpen);
            };
            
            const createCartSummaryHTML = () => {
                const summaryHTML = `
                    <section id="cart-summary">
                        <h3>üõí Carrinho de Servi√ßos Avulsos</h3>
                        <ul id="cart-items">
                            <li>Nenhum servi√ßo avulso selecionado.</li>
                        </ul>
                        <div id="cart-total">
                            <span>Total:</span>
                            <span id="total-price">R$ 0,00</span>
                        </div>
                        <button id="checkout-button" class="checkout-button" disabled>Finalizar Compra e Agendar</button>
                    </section>
                `;
                floatingCartWrapper.insertAdjacentHTML('beforeend', summaryHTML);
                
                cartSummaryElement = document.getElementById('cart-summary');
                cartItemsList = document.getElementById('cart-items');
                totalPriceSpan = document.getElementById('total-price');
                checkoutButton = document.getElementById('checkout-button');

                checkoutButton.addEventListener('click', handleCheckout);
            };

            const renderCart = () => {
                if (!cartSummaryElement) {
                    createCartSummaryHTML();
                }

                cartItemsList.innerHTML = '';
                let total = 0;

                if (cart.length === 0) {
                    cartItemsList.innerHTML = '<li>Nenhum servi√ßo avulso selecionado.</li>';
                    checkoutButton.disabled = true;
                } else {
                    cart.forEach(item => {
                        const li = document.createElement('li');
                        li.innerHTML = `<span>${item.name}</span><strong>${formatToBRL(item.price)}</strong>`;
                        cartItemsList.appendChild(li);
                        total += item.price;
                    });
                    checkoutButton.disabled = false;
                }

                totalPriceSpan.textContent = formatToBRL(total);
                cartCountSpan.textContent = cart.length;
                
                floatingCartIcon.style.display = 'flex';
            };

            const handleCheckboxChange = (event) => {
                const checkbox = event.target;
                const serviceName = checkbox.dataset.name;
                const servicePrice = formatPrice(checkbox.dataset.price);

                if (checkbox.checked) {
                    cart.push({
                        name: serviceName,
                        price: servicePrice
                    });
                } else {
                    const index = cart.findIndex(item => item.name === serviceName && item.price === servicePrice);
                    if (index > -1) {
                        cart.splice(index, 1);
                    }
                }

                renderCart();
            };
            
            const handleCheckout = () => {
                const total = formatPrice(totalPriceSpan.textContent);
                const itemsList = cart.map(item => `- ${item.name} (${formatToBRL(item.price)})`).join('\n');
                
                const checkoutMessage = 
`Ol√°, gostaria de agendar os seguintes servi√ßos para meu ve√≠culo ${currentCarType}:

${itemsList}

Total: ${formatToBRL(total)}

*Favor confirmar a disponibilidade de hor√°rio.*`;
                
                const whatsappUrl = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(checkoutMessage)}`;
                window.open(whatsappUrl, '_blank');
            };


            const generateServicesHTML = (data) => {
                const services = data.additional_services;
                const combos = data.combos;
                let html = '';

                // Servi√ßos Avulsos
                html += `
                    <section class="additional-services">
                        <h3>Servi√ßos Avulsos para ${currentCarType} (Monte seu Pedido)</h3>
                `;

                services.forEach(service => {
                    const priceValue = formatPrice(service.price);

                    html += `
                        <div class="service-item">
                            <input type="checkbox" id="${service.name.replace(/\s/g, '-')}-${currentCarType}"
                                data-name="${service.name} (${currentCarType})"
                                data-price="${priceValue}">
                            <div class="service-details">
                                <h4>${service.name}</h4>
                                <p>${service.description}</p>
                                <span class="price">Pre√ßo: ${service.price}</span>
                            </div>
                        </div>
                    `;
                });
                html += '</section>';

                // Combos
                html += `
                    <section class="combo-section-group">
                        <h3>Combos de Servi√ßos para ${currentCarType}</h3>
                `;
                combos.forEach(combo => {
                    let tableRows = combo.table.map(row => 
                        `<tr><td>${row[0]}</td><td style="text-align: right;">${row[1]}</td></tr>`
                    ).join('');
                    
                    let includesList = combo.includes.map(item => `<li>${item}</li>`).join('');

                    html += `
                        <div class="combo-section">
                            <h4>${combo.name}</h4>
                            <table>
                                ${tableRows}
                            </table>
                            <ul>
                                ${includesList}
                            </ul>
                        </div>
                    `;
                });
                html += '</section>';

                return html;
            };
            
            const showServices = (carType) => {
                currentCarType = carType;
                carTypeTitle.textContent = `Servi√ßos para ${carType}`;
                
                if (!carData[carType]) {
                    servicesContent.innerHTML = `<p style="text-align: center; color: var(--primary-red);">Erro: Dados de servi√ßo para ${carType} n√£o encontrados.</p>`;
                    return;
                }
                
                servicesContent.innerHTML = generateServicesHTML(carData[carType]);

                carSelectionSection.style.display = 'none';
                servicesDisplaySection.style.display = 'block';

                const checkboxes = servicesContent.querySelectorAll('input[type="checkbox"]');
                checkboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', handleCheckboxChange);
                });
                
                if (!cartSummaryElement) {
                     createCartSummaryHTML();
                }

                cart = [];
                renderCart();
            };

            const backToSelection = () => {
                carSelectionSection.style.display = 'block';
                servicesDisplaySection.style.display = 'none';
                cart = []; 
                renderCart();
                isCartOpen = true;
                toggleFloatingCart();
            };

            carTypeButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    const carType = event.target.dataset.car;
                    showServices(carType);

                    carTypeButtons.forEach(btn => btn.classList.remove('active'));
                    event.target.classList.add('active');
                });
            });

            backButton.addEventListener('click', backToSelection);
            floatingCartIcon.addEventListener('click', toggleFloatingCart);

            createCartSummaryHTML();
            renderCart();
        });
    </script>
    
</body>
</html>
